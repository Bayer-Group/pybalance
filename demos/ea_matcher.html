<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Genetic Matcher &mdash; PyBalance</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=f6245a2f"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Constraint Satisfaction Matcher" href="lp_matcher.html" />
    <link rel="prev" title="Propensity Score Matcher" href="ps_matcher.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PyBalance
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../00_introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_installation.html">Installation instructions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../02_demos.html">Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="matching_data.html">Matching Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="ps_matcher.html">Propensity Score Matcher</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Genetic Matcher</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Optimize-Beta-(Mean-Absolute-SMD)">Optimize Beta (Mean Absolute SMD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Optimize-Beta^2">Optimize Beta^2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Optimize-Gamma-(Area-Between-CDFs)">Optimize Gamma (Area Between CDFs)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lp_matcher.html">Constraint Satisfaction Matcher</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../03_api.html">API documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">License &amp; Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../04_license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_help.html">Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyBalance</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../02_demos.html">Demos</a></li>
      <li class="breadcrumb-item active">Genetic Matcher</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/demos/ea_matcher.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Genetic-Matcher">
<h1>Genetic Matcher<a class="headerlink" href="#Genetic-Matcher" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>The GeneticMatcher can be used to optimize any function of the baseline covariates, both linear and non-linear. In this demo notebook, we show how to call the matcher in the PyBalance library, including an example of a non-linear balance function.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(levelname)-4s</span><span class="s2"> [</span><span class="si">%(filename)s</span><span class="s2">:</span><span class="si">%(lineno)d</span><span class="s2">] </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">pybalance.sim</span> <span class="kn">import</span> <span class="n">generate_toy_dataset</span>
<span class="kn">from</span> <span class="nn">pybalance.utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BetaBalance</span><span class="p">,</span>
    <span class="n">BetaSquaredBalance</span><span class="p">,</span>
    <span class="n">BetaXBalance</span><span class="p">,</span>
    <span class="n">BetaMaxBalance</span><span class="p">,</span>
    <span class="n">GammaBalance</span><span class="p">,</span>
    <span class="n">GammaSquaredBalance</span><span class="p">,</span>
    <span class="n">GammaXBalance</span><span class="p">,</span>
    <span class="n">GammaXTreeBalance</span><span class="p">,</span>
    <span class="n">MatchingData</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pybalance.genetic</span> <span class="kn">import</span> <span class="n">GeneticMatcher</span><span class="p">,</span> <span class="n">get_global_defaults</span>
<span class="kn">from</span> <span class="nn">pybalance.visualization</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">plot_numeric_features</span><span class="p">,</span>
    <span class="n">plot_categoric_features</span><span class="p">,</span>
    <span class="n">plot_binary_features</span><span class="p">,</span>
    <span class="n">plot_per_feature_loss</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">time_limit</span> <span class="o">=</span> <span class="mi">300</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">generate_toy_dataset</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
        <b>Headers Numeric: </b><br>
        ['age', 'height', 'weight']<br><br>
        <b>Headers Categoric: </b><br>
        ['gender', 'haircolor', 'country', 'binary_0', 'binary_1', 'binary_2', 'binary_3'] <br><br>
        <b>Populations</b> <br>
        ['pool', 'target'] <br>
        <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>gender</th>
      <th>haircolor</th>
      <th>country</th>
      <th>population</th>
      <th>binary_0</th>
      <th>binary_1</th>
      <th>binary_2</th>
      <th>binary_3</th>
      <th>patient_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>62.511573</td>
      <td>190.229250</td>
      <td>105.165097</td>
      <td>0.0</td>
      <td>2</td>
      <td>3</td>
      <td>pool</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>68.505065</td>
      <td>161.121236</td>
      <td>95.001474</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>pool</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50.071384</td>
      <td>162.325356</td>
      <td>84.290576</td>
      <td>1.0</td>
      <td>0</td>
      <td>5</td>
      <td>pool</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>44.423692</td>
      <td>150.948096</td>
      <td>82.031381</td>
      <td>1.0</td>
      <td>2</td>
      <td>2</td>
      <td>pool</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41.695052</td>
      <td>132.952651</td>
      <td>54.857540</td>
      <td>0.0</td>
      <td>1</td>
      <td>3</td>
      <td>pool</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>21.474205</td>
      <td>168.602546</td>
      <td>70.342128</td>
      <td>0.0</td>
      <td>2</td>
      <td>5</td>
      <td>target</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>10995</td>
    </tr>
    <tr>
      <th>996</th>
      <td>40.643320</td>
      <td>188.188724</td>
      <td>61.611744</td>
      <td>0.0</td>
      <td>2</td>
      <td>4</td>
      <td>target</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>10996</td>
    </tr>
    <tr>
      <th>997</th>
      <td>29.472765</td>
      <td>161.408162</td>
      <td>57.214095</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>target</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>10997</td>
    </tr>
    <tr>
      <th>998</th>
      <td>41.291949</td>
      <td>150.968833</td>
      <td>91.270798</td>
      <td>0.0</td>
      <td>0</td>
      <td>3</td>
      <td>target</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10998</td>
    </tr>
    <tr>
      <th>999</th>
      <td>67.530294</td>
      <td>155.124741</td>
      <td>56.196505</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>target</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10999</td>
    </tr>
  </tbody>
</table>
<p>11000 rows √ó 12 columns</p>
</div></div>
</div>
<section id="Optimize-Beta-(Mean-Absolute-SMD)">
<h2>Optimize Beta (Mean Absolute SMD)<a class="headerlink" href="#Optimize-Beta-(Mean-Absolute-SMD)" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objective</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">BetaBalance</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">matcher</span> <span class="o">=</span> <span class="n">matcher_beta</span> <span class="o">=</span> <span class="n">GeneticMatcher</span><span class="p">(</span>
    <span class="n">matching_data</span> <span class="o">=</span> <span class="n">m</span><span class="p">,</span>
    <span class="n">objective</span> <span class="o">=</span> <span class="n">objective</span><span class="p">,</span>
    <span class="n">log_every</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">n_generations</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span>
    <span class="n">time_limit</span> <span class="o">=</span> <span class="n">time_limit</span>
<span class="p">)</span>
<span class="n">matcher</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO [matcher.py:125] cpu
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;objective&#39;: &#39;beta&#39;,
 &#39;candidate_population_size&#39;: 1000,
 &#39;n_candidate_populations&#39;: 1024,
 &#39;n_keep_best&#39;: 256,
 &#39;n_voting_populations&#39;: 256,
 &#39;n_mutation&#39;: 256,
 &#39;n_generations&#39;: 5000,
 &#39;n_iter_no_change&#39;: 100,
 &#39;time_limit&#39;: 300,
 &#39;max_batch_size_gb&#39;: 2,
 &#39;seed&#39;: 1234,
 &#39;verbose&#39;: True,
 &#39;log_every&#39;: 1000,
 &#39;initialization&#39;: {&#39;benchmarks&#39;: {&#39;propensity&#39;: &#39;include&#39;},
  &#39;sampling&#39;: {&#39;propensity&#39;: 1.0, &#39;uniform&#39;: 1.0}}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matcher_beta</span><span class="o">.</span><span class="n">match</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO [initialization.py:31] Optimizing balance with genetic algorithm ...
INFO [initialization.py:32] Initial balance scores:
INFO [initialization.py:37]     beta:   0.233
INFO [initialization.py:38] Initializing candidate populations ...
INFO [initialization.py:86] Computing PROPENSITY 1-1 matching method ...
INFO [matcher.py:180] Training model SGDClassifier (iter 1/50, 0.001 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: SGDClassifier
INFO [matcher.py:139]   * alpha: 1.5074398973827774
INFO [matcher.py:139]   * class_weight: None
INFO [matcher.py:139]   * early_stopping: True
INFO [matcher.py:139]   * fit_intercept: True
INFO [matcher.py:139]   * loss: log_loss
INFO [matcher.py:139]   * max_iter: 1500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:140]   Score (beta): 0.0525
INFO [matcher.py:141]   Solution time: 0.002 min
INFO [matcher.py:180] Training model LogisticRegression (iter 2/50, 0.002 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 0.05835496346821344
INFO [matcher.py:139]   * fit_intercept: True
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta): 0.0291
INFO [matcher.py:141]   Solution time: 0.004 min
INFO [matcher.py:180] Training model LogisticRegression (iter 3/50, 0.004 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model SGDClassifier (iter 4/50, 0.028 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 5/50, 0.029 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model LogisticRegression (iter 6/50, 0.050 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 7/50, 0.052 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 8/50, 0.055 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 9/50, 0.056 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 10/50, 0.073 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 11/50, 0.075 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 12/50, 0.078 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 13/50, 0.079 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 14/50, 0.080 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 15/50, 0.082 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 16/50, 0.083 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 17/50, 0.085 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 18/50, 0.087 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 2.3905570899706423
INFO [matcher.py:139]   * fit_intercept: True
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta): 0.0289
INFO [matcher.py:141]   Solution time: 0.090 min
INFO [matcher.py:180] Training model LogisticRegression (iter 19/50, 0.090 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 20/50, 0.101 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 21/50, 0.102 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 22/50, 0.104 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 23/50, 0.105 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 24/50, 0.107 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 25/50, 0.109 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 26/50, 0.111 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 0.2699411413616818
INFO [matcher.py:139]   * fit_intercept: True
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l1
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta): 0.0288
INFO [matcher.py:141]   Solution time: 0.113 min
INFO [matcher.py:180] Training model LogisticRegression (iter 27/50, 0.113 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 28/50, 0.115 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 29/50, 0.133 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 30/50, 0.135 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 31/50, 0.137 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 32/50, 0.139 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 33/50, 0.141 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 34/50, 0.142 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 35/50, 0.144 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model LogisticRegression (iter 36/50, 0.167 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 37/50, 0.172 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 0.5868985298319505
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l1
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta): 0.0249
INFO [matcher.py:141]   Solution time: 0.195 min
INFO [matcher.py:180] Training model SGDClassifier (iter 38/50, 0.195 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 39/50, 0.197 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 40/50, 0.199 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 41/50, 0.201 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 42/50, 0.203 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 43/50, 0.213 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 44/50, 0.233 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 45/50, 0.234 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 46/50, 0.235 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model LogisticRegression (iter 47/50, 0.257 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model SGDClassifier (iter 48/50, 0.279 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 49/50, 0.281 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 50/50, 0.282 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 0.5868985298319505
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l1
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta): 0.0249
INFO [matcher.py:141]   Solution time: 0.195 min
INFO [initialization.py:66]     beta:   0.025
INFO [initialization.py:71]     Included in initial population.

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO [initialization.py:132] Sampling 512 candidate populations according to PROPENSITY distribution ...

INFO [initialization.py:132] Sampling 511 candidate populations according to UNIFORM distribution ...

INFO [logger.py:34] Generation 0
INFO [logger.py:35]     remaining patients: 10000
INFO [logger.py:36]     elapsed time: 0.31 min
INFO [logger.py:45]     best beta: 0.02494      worst beta: 0.25118
INFO [logger.py:34] Generation 1000
INFO [logger.py:35]     remaining patients: 7451
INFO [logger.py:36]     elapsed time: 4.36 min
INFO [logger.py:45]     best beta: 0.01141      worst beta: 0.24623
INFO [matcher.py:211] Time limit exceeded. Stopping.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
        <b>Headers Numeric: </b><br>
        ['age', 'height', 'weight']<br><br>
        <b>Headers Categoric: </b><br>
        ['gender', 'haircolor', 'country', 'binary_0', 'binary_1', 'binary_2', 'binary_3'] <br><br>
        <b>Populations</b> <br>
        ['pool', 'target'] <br>
        <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>gender</th>
      <th>haircolor</th>
      <th>country</th>
      <th>population</th>
      <th>binary_0</th>
      <th>binary_1</th>
      <th>binary_2</th>
      <th>binary_3</th>
      <th>patient_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>55.261578</td>
      <td>139.396134</td>
      <td>94.438359</td>
      <td>0.0</td>
      <td>2</td>
      <td>2</td>
      <td>target</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>63.113091</td>
      <td>165.563337</td>
      <td>67.433016</td>
      <td>1.0</td>
      <td>2</td>
      <td>2</td>
      <td>target</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>10001</td>
    </tr>
    <tr>
      <th>2</th>
      <td>58.232216</td>
      <td>160.859857</td>
      <td>71.915385</td>
      <td>1.0</td>
      <td>0</td>
      <td>2</td>
      <td>target</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10002</td>
    </tr>
    <tr>
      <th>3</th>
      <td>58.996941</td>
      <td>140.357415</td>
      <td>115.606615</td>
      <td>1.0</td>
      <td>0</td>
      <td>3</td>
      <td>target</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>10003</td>
    </tr>
    <tr>
      <th>4</th>
      <td>36.850195</td>
      <td>189.983706</td>
      <td>53.000581</td>
      <td>0.0</td>
      <td>2</td>
      <td>5</td>
      <td>target</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10004</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>28.382714</td>
      <td>155.203257</td>
      <td>73.126127</td>
      <td>0.0</td>
      <td>2</td>
      <td>5</td>
      <td>pool</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>43</td>
    </tr>
    <tr>
      <th>4050</th>
      <td>44.186246</td>
      <td>133.221816</td>
      <td>97.047691</td>
      <td>1.0</td>
      <td>0</td>
      <td>4</td>
      <td>pool</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4050</td>
    </tr>
    <tr>
      <th>8313</th>
      <td>46.510049</td>
      <td>130.960298</td>
      <td>88.501597</td>
      <td>1.0</td>
      <td>2</td>
      <td>4</td>
      <td>pool</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>8313</td>
    </tr>
    <tr>
      <th>7166</th>
      <td>57.061793</td>
      <td>157.544063</td>
      <td>70.784043</td>
      <td>1.0</td>
      <td>2</td>
      <td>4</td>
      <td>pool</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>7166</td>
    </tr>
    <tr>
      <th>569</th>
      <td>50.174501</td>
      <td>161.973210</td>
      <td>83.131287</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>pool</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>569</td>
    </tr>
  </tbody>
</table>
<p>2000 rows √ó 12 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">match</span> <span class="o">=</span> <span class="n">matcher_beta</span><span class="o">.</span><span class="n">get_best_match</span><span class="p">()</span>
<span class="n">m_data</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">get_population</span><span class="p">(</span><span class="s1">&#39;pool&#39;</span><span class="p">)</span>
<span class="n">m_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;population&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m_data</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (prematch)&#39;</span>
<span class="k">match</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_data</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_per_feature_loss</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">debin</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_numeric_features</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pool (prematch)&#39;</span><span class="p">,</span> <span class="s1">&#39;pool&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="p">])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_categoric_features</span><span class="p">(</span><span class="n">match</span><span class="p">,</span>  <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pool (prematch)&#39;</span><span class="p">,</span> <span class="s1">&#39;pool&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demos_ea_matcher_6_0.png" src="../_images/demos_ea_matcher_6_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demos_ea_matcher_6_1.png" src="../_images/demos_ea_matcher_6_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demos_ea_matcher_6_2.png" src="../_images/demos_ea_matcher_6_2.png" />
</div>
</div>
</section>
<section id="Optimize-Beta^2">
<h2>Optimize Beta^2<a class="headerlink" href="#Optimize-Beta^2" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objective</span> <span class="o">=</span> <span class="n">beta2</span> <span class="o">=</span> <span class="n">BetaSquaredBalance</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">matcher</span> <span class="o">=</span> <span class="n">matcher_beta2</span> <span class="o">=</span> <span class="n">GeneticMatcher</span><span class="p">(</span>
    <span class="n">matching_data</span> <span class="o">=</span> <span class="n">m</span><span class="p">,</span>
    <span class="n">objective</span> <span class="o">=</span> <span class="n">objective</span><span class="p">,</span>
    <span class="n">log_every</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">n_generations</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span>
    <span class="n">time_limit</span> <span class="o">=</span> <span class="n">time_limit</span>
<span class="p">)</span>
<span class="n">matcher</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO [matcher.py:125] cpu
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;objective&#39;: &#39;beta_squared&#39;,
 &#39;candidate_population_size&#39;: 1000,
 &#39;n_candidate_populations&#39;: 1024,
 &#39;n_keep_best&#39;: 256,
 &#39;n_voting_populations&#39;: 256,
 &#39;n_mutation&#39;: 256,
 &#39;n_generations&#39;: 5000,
 &#39;n_iter_no_change&#39;: 100,
 &#39;time_limit&#39;: 300,
 &#39;max_batch_size_gb&#39;: 2,
 &#39;seed&#39;: 1234,
 &#39;verbose&#39;: True,
 &#39;log_every&#39;: 1000,
 &#39;initialization&#39;: {&#39;benchmarks&#39;: {&#39;propensity&#39;: &#39;include&#39;},
  &#39;sampling&#39;: {&#39;propensity&#39;: 1.0, &#39;uniform&#39;: 1.0}}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="n">match</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO [initialization.py:31] Optimizing balance with genetic algorithm ...
INFO [initialization.py:32] Initial balance scores:
INFO [initialization.py:37]     beta_squared:   0.263
INFO [initialization.py:38] Initializing candidate populations ...
INFO [initialization.py:86] Computing PROPENSITY 1-1 matching method ...
INFO [matcher.py:180] Training model SGDClassifier (iter 1/50, 0.001 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: SGDClassifier
INFO [matcher.py:139]   * alpha: 1.5074398973827774
INFO [matcher.py:139]   * class_weight: None
INFO [matcher.py:139]   * early_stopping: True
INFO [matcher.py:139]   * fit_intercept: True
INFO [matcher.py:139]   * loss: log_loss
INFO [matcher.py:139]   * max_iter: 1500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:140]   Score (beta_squared): 0.0603
INFO [matcher.py:141]   Solution time: 0.004 min
INFO [matcher.py:180] Training model LogisticRegression (iter 2/50, 0.004 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 0.05835496346821344
INFO [matcher.py:139]   * fit_intercept: True
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta_squared): 0.0374
INFO [matcher.py:141]   Solution time: 0.007 min
INFO [matcher.py:180] Training model LogisticRegression (iter 3/50, 0.007 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 16.16555309446666
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l1
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta_squared): 0.0357
INFO [matcher.py:141]   Solution time: 0.044 min
INFO [matcher.py:180] Training model SGDClassifier (iter 4/50, 0.044 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 5/50, 0.048 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 54.02072493419677
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta_squared): 0.0347
INFO [matcher.py:141]   Solution time: 0.080 min
INFO [matcher.py:180] Training model LogisticRegression (iter 6/50, 0.081 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 7/50, 0.085 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 8/50, 0.089 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 9/50, 0.092 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 10/50, 0.117 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 11/50, 0.120 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 12/50, 0.124 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 13/50, 0.126 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 14/50, 0.129 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 15/50, 0.131 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 16/50, 0.134 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 17/50, 0.136 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 18/50, 0.139 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 19/50, 0.143 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 20/50, 0.165 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 21/50, 0.168 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 22/50, 0.170 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 23/50, 0.177 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 24/50, 0.181 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 25/50, 0.186 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 26/50, 0.188 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 27/50, 0.192 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 28/50, 0.196 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 29/50, 0.224 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 30/50, 0.226 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 31/50, 0.232 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 32/50, 0.235 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 33/50, 0.238 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 34/50, 0.241 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 35/50, 0.245 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model LogisticRegression (iter 36/50, 0.280 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 37/50, 0.288 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 0.5868985298319505
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l1
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta_squared): 0.0311
INFO [matcher.py:141]   Solution time: 0.322 min
INFO [matcher.py:180] Training model SGDClassifier (iter 38/50, 0.323 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 39/50, 0.325 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 40/50, 0.328 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 41/50, 0.331 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 42/50, 0.333 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 43/50, 0.350 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 44/50, 0.381 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 45/50, 0.385 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 46/50, 0.387 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model LogisticRegression (iter 47/50, 0.423 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model SGDClassifier (iter 48/50, 0.458 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 49/50, 0.460 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 50/50, 0.462 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 0.5868985298319505
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l1
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (beta_squared): 0.0311
INFO [matcher.py:141]   Solution time: 0.322 min
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO [initialization.py:66]     beta_squared:   0.031
INFO [initialization.py:71]     Included in initial population.

INFO [initialization.py:132] Sampling 512 candidate populations according to PROPENSITY distribution ...

INFO [initialization.py:132] Sampling 511 candidate populations according to UNIFORM distribution ...

INFO [logger.py:34] Generation 0
INFO [logger.py:35]     remaining patients: 10000
INFO [logger.py:36]     elapsed time: 0.51 min
INFO [logger.py:45]     best beta_squared: 0.03106      worst beta_squared: 0.28163
INFO [matcher.py:211] Time limit exceeded. Stopping.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">match</span> <span class="o">=</span> <span class="n">matcher_beta2</span><span class="o">.</span><span class="n">get_best_match</span><span class="p">()</span>
<span class="n">m_data</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">get_population</span><span class="p">(</span><span class="s1">&#39;pool&#39;</span><span class="p">)</span>
<span class="n">m_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;population&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m_data</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (prematch)&#39;</span>
<span class="k">match</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_data</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_per_feature_loss</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">debin</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_numeric_features</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pool (prematch)&#39;</span><span class="p">,</span> <span class="s1">&#39;pool&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="p">])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_categoric_features</span><span class="p">(</span><span class="n">match</span><span class="p">,</span>  <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pool (prematch)&#39;</span><span class="p">,</span> <span class="s1">&#39;pool&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demos_ea_matcher_10_0.png" src="../_images/demos_ea_matcher_10_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demos_ea_matcher_10_1.png" src="../_images/demos_ea_matcher_10_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demos_ea_matcher_10_2.png" src="../_images/demos_ea_matcher_10_2.png" />
</div>
</div>
</section>
<section id="Optimize-Gamma-(Area-Between-CDFs)">
<h2>Optimize Gamma (Area Between CDFs)<a class="headerlink" href="#Optimize-Gamma-(Area-Between-CDFs)" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objective</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">GammaBalance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">feature_weights</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">matcher</span> <span class="o">=</span> <span class="n">matcher_gamma</span> <span class="o">=</span> <span class="n">GeneticMatcher</span><span class="p">(</span>
    <span class="n">matching_data</span> <span class="o">=</span> <span class="n">m</span><span class="p">,</span>
    <span class="n">objective</span> <span class="o">=</span> <span class="n">objective</span><span class="p">,</span>
    <span class="n">log_every</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">n_generations</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span>
    <span class="n">time_limit</span> <span class="o">=</span> <span class="n">time_limit</span>
<span class="p">)</span>
<span class="n">matcher</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO [preprocess.py:335] Discretized age with bins [18.05, 27.54, 37.04, 46.53, 56.02, 65.51, 75.0].
INFO [preprocess.py:335] Discretized height with bins [125.01, 136.68, 148.34, 160.01, 171.67, 183.34, 195.0].
INFO [preprocess.py:335] Discretized weight with bins [50.0, 61.67, 73.33, 85.0, 96.66, 108.33, 120.0].
INFO [matcher.py:125] cpu
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;objective&#39;: &#39;gamma&#39;,
 &#39;candidate_population_size&#39;: 1000,
 &#39;n_candidate_populations&#39;: 1024,
 &#39;n_keep_best&#39;: 256,
 &#39;n_voting_populations&#39;: 256,
 &#39;n_mutation&#39;: 256,
 &#39;n_generations&#39;: 5000,
 &#39;n_iter_no_change&#39;: 100,
 &#39;time_limit&#39;: 300,
 &#39;max_batch_size_gb&#39;: 2,
 &#39;seed&#39;: 1234,
 &#39;verbose&#39;: True,
 &#39;log_every&#39;: 1000,
 &#39;initialization&#39;: {&#39;benchmarks&#39;: {&#39;propensity&#39;: &#39;include&#39;},
  &#39;sampling&#39;: {&#39;propensity&#39;: 1.0, &#39;uniform&#39;: 1.0}}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">match</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="n">match</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO [initialization.py:31] Optimizing balance with genetic algorithm ...
INFO [initialization.py:32] Initial balance scores:
INFO [initialization.py:37]     gamma:  0.217
INFO [initialization.py:38] Initializing candidate populations ...
INFO [initialization.py:86] Computing PROPENSITY 1-1 matching method ...
INFO [matcher.py:180] Training model SGDClassifier (iter 1/50, 0.001 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: SGDClassifier
INFO [matcher.py:139]   * alpha: 1.5074398973827774
INFO [matcher.py:139]   * class_weight: None
INFO [matcher.py:139]   * early_stopping: True
INFO [matcher.py:139]   * fit_intercept: True
INFO [matcher.py:139]   * loss: log_loss
INFO [matcher.py:139]   * max_iter: 1500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:140]   Score (gamma): 0.1083
INFO [matcher.py:141]   Solution time: 0.004 min
INFO [matcher.py:180] Training model LogisticRegression (iter 2/50, 0.004 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 0.05835496346821344
INFO [matcher.py:139]   * fit_intercept: True
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (gamma): 0.0391
INFO [matcher.py:141]   Solution time: 0.008 min
INFO [matcher.py:180] Training model LogisticRegression (iter 3/50, 0.008 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 16.16555309446666
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l1
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (gamma): 0.0376
INFO [matcher.py:141]   Solution time: 0.055 min
INFO [matcher.py:180] Training model SGDClassifier (iter 4/50, 0.055 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 5/50, 0.058 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 54.02072493419677
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (gamma): 0.0337
INFO [matcher.py:141]   Solution time: 0.091 min
INFO [matcher.py:180] Training model LogisticRegression (iter 6/50, 0.091 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 7/50, 0.095 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 8/50, 0.098 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 9/50, 0.101 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 13.179630432958701
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (gamma): 0.0269
INFO [matcher.py:141]   Solution time: 0.135 min
INFO [matcher.py:180] Training model LogisticRegression (iter 10/50, 0.135 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 11/50, 0.138 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 12/50, 0.142 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 13/50, 0.144 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 14/50, 0.146 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 15/50, 0.149 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 16/50, 0.151 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 17/50, 0.154 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 18/50, 0.158 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 19/50, 0.165 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model SGDClassifier (iter 20/50, 0.196 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 21/50, 0.199 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 22/50, 0.201 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 23/50, 0.203 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 24/50, 0.206 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 25/50, 0.211 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 26/50, 0.213 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 27/50, 0.219 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 28/50, 0.222 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model SGDClassifier (iter 29/50, 0.263 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 30/50, 0.265 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 31/50, 0.271 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 32/50, 0.273 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 33/50, 0.277 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 34/50, 0.279 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 35/50, 0.281 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model LogisticRegression (iter 36/50, 0.320 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 37/50, 0.333 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model SGDClassifier (iter 38/50, 0.370 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 39/50, 0.372 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 40/50, 0.374 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 41/50, 0.378 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 42/50, 0.380 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model LogisticRegression (iter 43/50, 0.409 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model SGDClassifier (iter 44/50, 0.446 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 45/50, 0.448 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 46/50, 0.450 min) ...
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model LogisticRegression (iter 47/50, 0.486 min) ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/sprivite/src/pybalance/venv/pybalance/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
INFO [matcher.py:180] Training model SGDClassifier (iter 48/50, 0.524 min) ...
INFO [matcher.py:180] Training model SGDClassifier (iter 49/50, 0.526 min) ...
INFO [matcher.py:180] Training model LogisticRegression (iter 50/50, 0.528 min) ...
INFO [matcher.py:136] Best propensity score match found:
INFO [matcher.py:137]   Model: LogisticRegression
INFO [matcher.py:139]   * C: 13.179630432958701
INFO [matcher.py:139]   * fit_intercept: False
INFO [matcher.py:139]   * max_iter: 500
INFO [matcher.py:139]   * penalty: l2
INFO [matcher.py:139]   * solver: saga
INFO [matcher.py:140]   Score (gamma): 0.0269
INFO [matcher.py:141]   Solution time: 0.135 min
INFO [initialization.py:66]     gamma:  0.027
INFO [initialization.py:71]     Included in initial population.

INFO [initialization.py:132] Sampling 512 candidate populations according to PROPENSITY distribution ...

INFO [initialization.py:132] Sampling 511 candidate populations according to UNIFORM distribution ...

INFO [logger.py:34] Generation 0
INFO [logger.py:35]     remaining patients: 10000
INFO [logger.py:36]     elapsed time: 0.55 min
INFO [logger.py:45]     best gamma: 0.02688     worst gamma: 0.23595
INFO [logger.py:34] Generation 1000
INFO [logger.py:35]     remaining patients: 7375
INFO [logger.py:36]     elapsed time: 4.93 min
INFO [logger.py:45]     best gamma: 0.01151     worst gamma: 0.24080
INFO [matcher.py:211] Time limit exceeded. Stopping.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">match</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="n">get_best_match</span><span class="p">()</span>
<span class="n">m_data</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">get_population</span><span class="p">(</span><span class="s1">&#39;pool&#39;</span><span class="p">)</span>
<span class="n">m_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;population&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m_data</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (prematch)&#39;</span>
<span class="k">match</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_data</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_per_feature_loss</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">debin</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_numeric_features</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pool (prematch)&#39;</span><span class="p">,</span> <span class="s1">&#39;pool&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="p">])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_categoric_features</span><span class="p">(</span><span class="n">match</span><span class="p">,</span>  <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pool (prematch)&#39;</span><span class="p">,</span> <span class="s1">&#39;pool&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demos_ea_matcher_14_0.png" src="../_images/demos_ea_matcher_14_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demos_ea_matcher_14_1.png" src="../_images/demos_ea_matcher_14_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demos_ea_matcher_14_2.png" src="../_images/demos_ea_matcher_14_2.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ps_matcher.html" class="btn btn-neutral float-left" title="Propensity Score Matcher" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lp_matcher.html" class="btn btn-neutral float-right" title="Constraint Satisfaction Matcher" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024 - Bayer AG - Stephen Privitera, Hooman Sedghamiz, Alex Hartenstein.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>